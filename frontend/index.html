<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PortfolioForge - AI Portfolio Builder</title>
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="PortfolioForge - AI Portfolio Builder" />
    <meta property="og:description" content="Create your perfect portfolio with AI" />
    <meta property="og:image" content="https://via.placeholder.com/1200x630/4F46E5/FFFFFF?text=PortfolioForge" />
    <meta property="og:url" content="" />
    <meta property="og:type" content="website" />
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="PortfolioForge - AI Portfolio Builder" />
    <meta name="twitter:description" content="Create your perfect portfolio with AI" />
    <meta name="twitter:image" content="https://via.placeholder.com/1200x630/4F46E5/FFFFFF?text=PortfolioForge" />
    
    <!-- Other meta tags -->
    <meta name="description" content="PortfolioForge - AI Portfolio Builder">
    <link rel="canonical" href="">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Roboto+Mono:wght@400;500&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <style>
        /* All your existing CSS styles remain the same */
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #ec4899;
            --dark: #0f172a;
            --darker: #020617;
            --light: #f8fafc;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: var(--darker);
            color: var(--light);
            overflow-x: hidden;
        }
        
        /* All your other CSS styles remain unchanged */
        .font-mono { font-family: 'Roboto Mono', monospace; }
        .hidden { display: none !important; }
        
        /* Animated Background */
        .animated-bg {
            background: linear-gradient(-45deg, #0f172a, #1e293b, #334155, #0f172a);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }
        
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* All other CSS styles remain the same */
        .glass {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Buttons */
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(99, 102, 241, 0.3);
        }
        
        .btn-primary:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(-100%);
            transition: transform 0.5s ease;
            z-index: -1;
        }
        
        .btn-primary:hover:before {
            transform: translateX(0);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary), #db2777);
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(236, 72, 153, 0.3);
        }
        
        /* Dropzone */
        .drop-zone {
            border: 2px dashed #475569;
            transition: all 0.3s ease;
        }
        
        .drop-zone:hover, .drop-zone.dragover {
            border-color: var(--primary);
            background-color: rgba(99, 102, 241, 0.1);
        }
        
        .drop-zone.has-file {
            border-color: #22c55e;
            background-color: rgba(34, 197, 94, 0.1);
        }
        
        /* Page transitions */
        .view { animation: fadeIn 0.5s ease-in-out; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Editor Styles */
        .editor-input {
            background-color: rgba(30, 41, 59, 0.5);
            border: 1px solid rgba(71, 85, 105, 0.5);
            color: var(--light);
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            width: 100%;
            transition: all 0.2s;
        }
        
        .editor-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }
        
        .editor-section {
            background: rgba(30, 41, 59, 0.5);
            backdrop-filter: blur(5px);
            border-radius: 0.75rem;
            padding: 1.5rem;
            border: 1px solid rgba(71, 85, 105, 0.3);
        }
        
        /* Theme Selector */
        .theme-option {
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .theme-option:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
        }
        
        .theme-option.selected {
            border-color: var(--primary);
            box-shadow: 0 0 15px rgba(99, 102, 241, 0.4);
        }
        
        /* Floating particles */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }
        
        .particle {
            position: absolute;
            background: rgba(99, 102, 241, 0.2);
            border-radius: 50%;
            pointer-events: none;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(30, 41, 59, 0.5);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }
        
        /* Social link buttons */
        .social-link {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .social-link:hover {
            transform: translateY(-3px);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
        }
        
        /* Loading spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Network status indicator */
        .network-status {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(30, 41, 59, 0.9);
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 1000;
        }
        
        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #22c55e;
            display: inline-block;
        }
        
        .status-indicator.error {
            background-color: #ef4444;
        }
        
        /* LinkedIn sharing fix */
        .linkedin-preview-container {
            margin-top: 20px;
            padding: 15px;
            background: rgba(30, 41, 59, 0.5);
            border-radius: 10px;
            border: 1px solid rgba(71, 85, 105, 0.3);
        }
        
        .linkedin-preview {
            display: flex;
            align-items: center;
            padding: 10px;
            background: white;
            color: black;
            border-radius: 8px;
            margin-bottom: 10px;
        }
        
        .linkedin-preview-image {
            width: 120px;
            height: 63px;
            background-color: #eee;
            margin-right: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 12px;
        }
        
        .linkedin-preview-content {
            flex: 1;
        }
        
        .linkedin-preview-title {
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .linkedin-preview-url {
            font-size: 12px;
            color: #666;
        }
    </style>
</head>
<body class="animated-bg min-h-screen">
    <div class="particles" id="particles"></div>
    
    <!-- Network Status Indicator -->
    <div class="network-status glass">
        <span class="status-indicator" id="statusIndicator"></span>
        <span id="statusText">Checking network...</span>
    </div>
    
    <div class="container mx-auto p-4 md:p-8 max-w-6xl relative z-10">
        <!-- Header -->
        <header class="flex justify-between items-center py-6 mb-8">
            <div class="flex items-center space-x-2">
                <div class="w-10 h-10 rounded-full bg-gradient-to-r from-indigo-500 to-purple-600 flex items-center justify-center">
                    <i class="fas fa-briefcase text-white"></i>
                </div>
                <h1 class="text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 to-purple-500">PortfolioForge</h1>
            </div>
            <nav>
                <ul class="flex space-x-6">
                    <li><a href="#" onclick="switchView('landingView')" class="text-gray-300 hover:text-white transition-colors">Home</a></li>
                    <li><a href="#" onclick="switchView('featuresView')" class="text-gray-300 hover:text-white transition-colors">Features</a></li>
                    <li><a href="#" onclick="switchView('contactView')" class="text-gray-300 hover:text-white transition-colors">Contact</a></li>
                </ul>
            </nav>
        </header>
        
        <!-- Landing View -->
        <div id="landingView" class="view">
            <div class="text-center py-12">
                <h1 class="text-4xl md:text-6xl font-bold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400">
                    Create Your Perfect Portfolio
                </h1>
                <p class="text-lg text-gray-400 mb-12 max-w-2xl mx-auto">
                    Choose your path: let our AI do the heavy lifting or build it yourself from scratch.
                </p>
                
                <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                    <div class="glass p-8 rounded-2xl border border-indigo-500/30 hover:border-indigo-400/50 transition-all cursor-pointer transform hover:-translate-y-2" onclick="switchView('aiView')">
                        <div class="w-16 h-16 rounded-full bg-gradient-to-r from-indigo-500 to-purple-600 flex items-center justify-center mx-auto mb-6">
                            <i class="fa-solid fa-wand-magic-sparkles text-white text-2xl"></i>
                        </div>
                        <h2 class="text-2xl font-bold mb-2">Create with AI</h2>
                        <p class="text-gray-400">Upload your resume and let our AI instantly generate a beautiful, professional portfolio tailored to you.</p>
                        <div class="mt-6 flex justify-center space-x-2">
                            <span class="px-3 py-1 bg-indigo-900/50 text-indigo-300 rounded-full text-xs">Fast</span>
                            <span class="px-3 py-1 bg-indigo-900/50 text-indigo-300 rounded-full text-xs">Smart</span>
                            <span class="px-3 py-1 bg-indigo-900/50 text-indigo-300 rounded-full text-xs">Professional</span>
                        </div>
                    </div>
                    
                    <div class="glass p-8 rounded-2xl border border-pink-500/30 hover:border-pink-400/50 transition-all cursor-pointer transform hover:-translate-y-2" onclick="switchView('editorView')">
                         <div class="w-16 h-16 rounded-full bg-gradient-to-r from-pink-500 to-rose-600 flex items-center justify-center mx-auto mb-6">
                            <i class="fa-solid fa-pen-ruler text-white text-2xl"></i>
                        </div>
                        <h2 class="text-2xl font-bold mb-2">Build Manually</h2>
                        <p class="text-gray-400">Take full control. Craft your portfolio from the ground up with our intuitive editor.</p>
                        <div class="mt-6 flex justify-center space-x-2">
                            <span class="px-3 py-1 bg-pink-900/50 text-pink-300 rounded-full text-xs">Customizable</span>
                            <span class="px-3 py-1 bg-pink-900/50 text-pink-300 rounded-full text-xs">Flexible</span>
                            <span class="px-3 py-1 bg-pink-900/50 text-pink-300 rounded-full text-xs">Creative</span>
                        </div>
                    </div>
                </div>
                
                <div class="mt-16">
                    <h3 class="text-2xl font-bold mb-6">How It Works</h3>
                    <div class="grid md:grid-cols-3 gap-6 max-w-4xl mx-auto">
                        <div class="glass p-6 rounded-xl">
                            <div class="w-12 h-12 rounded-full bg-indigo-900/50 flex items-center justify-center mx-auto mb-4">
                                <span class="text-indigo-400 font-bold">1</span>
                            </div>
                            <h4 class="font-bold mb-2">Upload or Create</h4>
                            <p class="text-gray-400 text-sm">Upload your resume or start from scratch</p>
                        </div>
                        <div class="glass p-6 rounded-xl">
                            <div class="w-12 h-12 rounded-full bg-purple-900/50 flex items-center justify-center mx-auto mb-4">
                                <span class="text-purple-400 font-bold">2</span>
                            </div>
                            <h4 class="font-bold mb-2">Customize</h4>
                            <p class="text-gray-400 text-sm">Edit content, change themes, add projects</p>
                        </div>
                        <div class="glass p-6 rounded-xl">
                            <div class="w-12 h-12 rounded-full bg-pink-900/50 flex items-center justify-center mx-auto mb-4">
                                <span class="text-pink-400 font-bold">3</span>
                            </div>
                            <h4 class="font-bold mb-2">Share</h4>
                            <p class="text-gray-400 text-sm">Get a unique link to share your portfolio</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Features View -->
        <div id="featuresView" class="view hidden">
            <button onclick="switchView('landingView')" class="mb-6 glass px-4 py-2 rounded-lg transition-colors hover:bg-slate-700/50">
                <i class="fa-solid fa-arrow-left mr-2"></i>Back to Home
            </button>
            
            <h2 class="text-3xl font-bold mb-6">Features</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="glass p-6 rounded-xl">
                    <div class="w-16 h-16 rounded-full bg-indigo-500 flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-magic text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">AI-Powered Generation</h3>
                    <p class="text-gray-400">Upload your resume and let AI create a professional portfolio in seconds.</p>
                </div>
                
                <div class="glass p-6 rounded-xl">
                    <div class="w-16 h-16 rounded-full bg-purple-500 flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-palette text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">Customizable Themes</h3>
                    <p class="text-gray-400">Choose from multiple professionally designed themes to match your style.</p>
                </div>
                
                <div class="glass p-6 rounded-xl">
                    <div class="w-16 h-16 rounded-full bg-pink-500 flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-share-nodes text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">Easy Sharing</h3>
                    <p class="text-gray-400">Share your portfolio with a unique link, QR code, or on social media.</p>
                </div>
                
                <div class="glass p-6 rounded-xl">
                    <div class="w-16 h-16 rounded-full bg-green-500 flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-pen text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">Manual Editor</h3>
                    <p class="text-gray-400">Take full control with our intuitive editor to build your portfolio from scratch.</p>
                </div>
                
                <div class="glass p-6 rounded-xl">
                    <div class="w-16 h-16 rounded-full bg-yellow-500 flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-mobile-alt text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">Responsive Design</h3>
                    <p class="text-gray-400">Your portfolio looks great on all devices, from desktop to mobile.</p>
                </div>
                
                <div class="glass p-6 rounded-xl">
                    <div class="w-16 h-16 rounded-full bg-blue-500 flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-cloud text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">Cloud Storage</h3>
                    <p class="text-gray-400">Your portfolio is stored securely in the cloud and accessible anywhere.</p>
                </div>
            </div>
            
            <div class="mt-12 glass p-8 rounded-2xl">
                <h3 class="text-2xl font-bold mb-4">Why Choose PortfolioForge?</h3>
                <p class="text-gray-400 mb-6">PortfolioForge combines cutting-edge AI technology with intuitive design tools to help you create a professional portfolio that stands out from the crowd.</p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="flex items-start">
                        <div class="w-10 h-10 rounded-full bg-indigo-900/50 flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-bolt text-indigo-400"></i>
                        </div>
                        <div>
                            <h4 class="font-bold mb-1">Lightning Fast</h4>
                            <p class="text-gray-400 text-sm">Create a stunning portfolio in minutes, not hours.</p>
                        </div>
                    </div>
                    
                    <div class="flex items-start">
                        <div class="w-10 h-10 rounded-full bg-purple-900/50 flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-shield-alt text-purple-400"></i>
                        </div>
                        <div>
                            <h4 class="font-bold mb-1">Secure & Private</h4>
                            <p class="text-gray-400 text-sm">Your data is encrypted and stored securely.</p>
                        </div>
                    </div>
                    
                    <div class="flex items-start">
                        <div class="w-10 h-10 rounded-full bg-pink-900/50 flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-chart-line text-pink-400"></i>
                        </div>
                        <div>
                            <h4 class="font-bold mb-1">Analytics Dashboard</h4>
                            <p class="text-gray-400 text-sm">Track who views your portfolio and from where.</p>
                        </div>
                    </div>
                    
                    <div class="flex items-start">
                        <div class="w-10 h-10 rounded-full bg-green-900/50 flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-sync text-green-400"></i>
                        </div>
                        <div>
                            <h4 class="font-bold mb-1">Always Up-to-Date</h4>
                            <p class="text-gray-400 text-sm">Regular updates with new features and improvements.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Contact View -->
        <div id="contactView" class="view hidden">
            <button onclick="switchView('landingView')" class="mb-6 glass px-4 py-2 rounded-lg transition-colors hover:bg-slate-700/50">
                <i class="fa-solid fa-arrow-left mr-2"></i>Back to Home
            </button>
            
            <h2 class="text-3xl font-bold mb-6">Contact Us</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-xl font-bold mb-4">Get in Touch</h3>
                    <p class="text-gray-400 mb-6">Have questions or feedback? We'd love to hear from you.</p>
                    
                    <form id="contactForm" class="space-y-4">
                        <div>
                            <label for="contactName" class="block mb-2">Name</label>
                            <input type="text" id="contactName" class="editor-input" required>
                        </div>
                        <div>
                            <label for="contactEmail" class="block mb-2">Email</label>
                            <input type="email" id="contactEmail" class="editor-input" required>
                        </div>
                        <div>
                            <label for="contactMessage" class="block mb-2">Message</label>
                            <textarea id="contactMessage" rows="4" class="editor-input" required></textarea>
                        </div>
                        <button type="submit" class="btn-primary text-white font-bold py-3 px-8 rounded-full">
                            Send Message
                        </button>
                    </form>
                </div>
                
                <div>
                    <h3 class="text-xl font-bold mb-4">Contact Information</h3>
                    
                    <div class="space-y-4">
                        <div class="flex items-start">
                            <i class="fas fa-map-marker-alt text-indigo-400 mt-1 mr-3"></i>
                            <div>
                                <h4 class="font-bold">Address</h4>
                                <p class="text-gray-400">123 Portfolio Street, Tech City, TC 12345</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <i class="fas fa-envelope text-indigo-400 mt-1 mr-3"></i>
                            <div>
                                <h4 class="font-bold">Email</h4>
                                <p class="text-gray-400">contact@portfolioforge.com</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <i class="fas fa-phone text-indigo-400 mt-1 mr-3"></i>
                            <div>
                                <h4 class="font-bold">Phone</h4>
                                <p class="text-gray-400">+1 (555) 123-4567</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-8">
                        <h3 class="text-xl font-bold mb-4">Follow Us</h3>
                        <div class="flex space-x-4">
                            <a href="#" class="social-link bg-indigo-900/50 hover:bg-indigo-800">
                                <i class="fab fa-twitter text-white"></i>
                            </a>
                            <a href="#" class="social-link bg-indigo-900/50 hover:bg-indigo-800">
                                <i class="fab fa-facebook text-white"></i>
                            </a>
                            <a href="#" class="social-link bg-indigo-900/50 hover:bg-indigo-800">
                                <i class="fab fa-linkedin text-white"></i>
                            </a>
                            <a href="#" class="social-link bg-indigo-900/50 hover:bg-indigo-800">
                                <i class="fab fa-instagram text-white"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- AI View -->
        <div id="aiView" class="view hidden">
            <button onclick="switchView('landingView')" class="mb-6 glass px-4 py-2 rounded-lg transition-colors hover:bg-slate-700/50">
                <i class="fa-solid fa-arrow-left mr-2"></i>Back
            </button>
            
            <div id="aiUploader" class="glass p-8 rounded-2xl border border-slate-700">
                <h2 class="text-3xl font-bold text-center mb-2">AI Portfolio Generator</h2>
                <p class="text-gray-400 text-center mb-8">Upload your resume and let AI create your professional portfolio</p>
                
                <div class="grid md:grid-cols-2 gap-8">
                    <div class="form-step">
                        <label class="block font-bold mb-3 text-lg flex items-center">
                            <i class="fas fa-user-circle mr-2 text-indigo-400"></i> Upload Your Photo
                        </label>
                        <div id="photoDropZone" class="drop-zone p-8 text-center rounded-xl cursor-pointer">
                            <i class="fa-solid fa-cloud-arrow-up text-4xl text-gray-500 mb-3"></i>
                            <p id="photoLabel" class="text-gray-400">Click or drag photo here</p>
                            <p class="text-xs text-gray-500 mt-2">JPG, PNG up to 5MB</p>
                        </div>
                        <input type="file" id="photoInput" accept="image/*" class="hidden">
                    </div>
                    
                    <div class="form-step">
                        <label class="block font-bold mb-3 text-lg flex items-center">
                            <i class="fas fa-file-pdf mr-2 text-rose-400"></i> Upload Your Resume
                        </label>
                        <div id="resumeDropZone" class="drop-zone p-8 text-center rounded-xl cursor-pointer">
                            <i class="fa-solid fa-cloud-arrow-up text-4xl text-gray-500 mb-3"></i>
                            <p id="resumeLabel" class="text-gray-400">Click or drag resume here</p>
                            <p class="text-xs text-gray-500 mt-2">PDF only, up to 10MB</p>
                        </div>
                        <input type="file" id="resumeInput" accept=".pdf" class="hidden">
                    </div>
                </div>
                
                <div class="text-center mt-10">
                    <button id="generateBtn" class="btn-primary text-white font-bold py-3 px-8 rounded-full text-lg transition-all">
                        <i class="fa-solid fa-wand-magic-sparkles mr-2"></i>Generate My Portfolio
                    </button>
                </div>
            </div>
            
            <div id="aiLoading" class="hidden text-center py-12">
                 <div class="inline-block relative">
                    <div class="w-16 h-16 rounded-full border-4 border-indigo-500 border-t-transparent animate-spin mx-auto"></div>
                    <div class="absolute inset-0 flex items-center justify-center">
                        <i class="fas fa-magic text-indigo-400 animate-pulse"></i>
                    </div>
                 </div>
                 <h3 class="text-2xl font-bold mt-6">AI is building your masterpiece...</h3>
                 <p class="text-gray-400 mt-2 max-w-md mx-auto">Analyzing your resume and designing your personalized portfolio</p>
                 <div class="mt-6 flex justify-center space-x-2">
                    <div class="w-3 h-3 rounded-full bg-indigo-500 animate-bounce" style="animation-delay: 0.1s"></div>
                    <div class="w-3 h-3 rounded-full bg-purple-500 animate-bounce" style="animation-delay: 0.2s"></div>
                    <div class="w-3 h-3 rounded-full bg-pink-500 animate-bounce" style="animation-delay: 0.3s"></div>
                 </div>
            </div>
        </div>
        
        <!-- Editor View -->
        <div id="editorView" class="view hidden">
             <button onclick="switchView('landingView')" class="mb-6 glass px-4 py-2 rounded-lg transition-colors hover:bg-slate-700/50">
                 <i class="fa-solid fa-arrow-left mr-2"></i>Back
             </button>
             
             <h2 class="text-3xl font-bold mb-6 flex items-center">
                 <i class="fas fa-edit mr-3 text-indigo-400"></i>Portfolio Editor
             </h2>
             
             <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                 <div class="lg:col-span-2 space-y-6">
                    <div class="editor-section">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-user mr-2 text-indigo-400"></i> Personal Information
                        </h3>
                        <div class="grid md:grid-cols-2 gap-4">
                            <input type="text" id="edit-name" placeholder="Full Name" class="editor-input">
                            <input type="email" id="edit-email" placeholder="Email Address" class="editor-input">
                            <input type="text" id="edit-phone" placeholder="Phone Number" class="editor-input">
                            <input type="text" id="edit-website" placeholder="Website URL" class="editor-input">
                            <input type="text" id="edit-linkedin" placeholder="LinkedIn Username (e.g., johndoe)" class="editor-input">
                            <input type="text" id="edit-github" placeholder="GitHub Username (e.g., johndoe)" class="editor-input">
                        </div>
                    </div>
                    
                    <div class="editor-section">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-file-lines mr-2 text-purple-400"></i> Professional Summary
                        </h3>
                        <textarea id="edit-summary" placeholder="Write a brief summary about yourself..." rows="4" class="editor-input"></textarea>
                    </div>
                    
                    <div class="editor-section">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-code mr-2 text-pink-400"></i> Skills
                        </h3>
                        <input type="text" id="edit-skills" placeholder="Enter skills, comma separated (e.g., JavaScript, React, Figma)" class="editor-input">
                    </div>
                    
                    <div class="editor-section">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-briefcase mr-2 text-green-400"></i> Work Experience
                        </h3>
                        <div id="experienceContainer" class="space-y-4">
                            <!-- Experience items will be added here dynamically -->
                        </div>
                        <button onclick="addExperience()" class="mt-4 text-sm text-indigo-400 hover:text-indigo-300 flex items-center">
                            <i class="fas fa-plus-circle mr-1"></i> Add Experience
                        </button>
                    </div>
                    
                    <div class="editor-section">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-folder-open mr-2 text-yellow-400"></i> Projects
                        </h3>
                        <div id="projectsContainer" class="space-y-4">
                            <!-- Project items will be added here dynamically -->
                        </div>
                        <button onclick="addProject()" class="mt-4 text-sm text-indigo-400 hover:text-indigo-300 flex items-center">
                            <i class="fas fa-plus-circle mr-1"></i> Add Project
                        </button>
                    </div>
                 </div>
                 
                 <div class="lg:col-span-1 space-y-6">
                    <div class="editor-section">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-palette mr-2 text-rose-400"></i> Theme Selection
                        </h3>
                        <div class="space-y-4">
                            <div class="theme-option p-4 rounded-xl bg-gray-800" data-theme="Software Developer">
                                <div class="flex items-center mb-2">
                                    <div class="w-8 h-8 rounded-full bg-blue-500 mr-3"></div>
                                    <h4 class="font-bold">Developer Dark</h4>
                                </div>
                                <p class="text-sm text-gray-400">Perfect for software developers and engineers</p>
                            </div>
                            
                            <div class="theme-option p-4 rounded-xl bg-gray-100 text-gray-800" data-theme="Graphic Designer">
                                <div class="flex items-center mb-2">
                                    <div class="w-8 h-8 rounded-full bg-pink-500 mr-3"></div>
                                    <h4 class="font-bold">Designer Light</h4>
                                </div>
                                <p class="text-sm text-gray-600">Ideal for designers and creative professionals</p>
                            </div>
                            
                            <div class="theme-option p-4 rounded-xl bg-gray-800" data-theme="Data Scientist">
                                <div class="flex items-center mb-2">
                                    <div class="w-8 h-8 rounded-full bg-green-500 mr-3"></div>
                                    <h4 class="font-bold">Data Green</h4>
                                </div>
                                <p class="text-sm text-gray-400">Great for data scientists and analysts</p>
                            </div>
                            
                            <div class="theme-option p-4 rounded-xl bg-gray-100 text-gray-800" data-theme="Default">
                                <div class="flex items-center mb-2">
                                    <div class="w-8 h-8 rounded-full bg-indigo-600 mr-3"></div>
                                    <h4 class="font-bold">Professional Blue</h4>
                                </div>
                                <p class="text-sm text-gray-600">Clean and professional for any industry</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="editor-section">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-image mr-2 text-cyan-400"></i> Profile Photo
                        </h3>
                        <div class="flex flex-col items-center">
                            <div id="profilePhotoPreview" class="w-32 h-32 rounded-full bg-gray-700 flex items-center justify-center mb-4 overflow-hidden">
                                <i class="fas fa-user text-gray-500 text-3xl"></i>
                            </div>
                            <div class="drop-zone p-4 text-center rounded-lg cursor-pointer w-full">
                                <i class="fas fa-cloud-arrow-up text-gray-500 mb-1"></i>
                                <p class="text-sm text-gray-400">Upload Photo</p>
                            </div>
                            <input type="file" id="editorPhotoInput" accept="image/*" class="hidden">
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <button id="saveAndPreviewBtn" onclick="saveAndPreview()" class="btn-secondary text-white font-bold py-3 px-8 rounded-full text-lg w-full">
                            <i class="fas fa-eye mr-2"></i>Save & Preview
                        </button>
                    </div>
                 </div>
             </div>
        </div>
        
        <!-- Portfolio View -->
        <div id="portfolioView" class="view hidden">
            <div class="flex flex-wrap gap-4 items-center mb-6">
                 <button onclick="handleBackToEditor()" class="glass px-4 py-2 rounded-lg transition-colors hover:bg-slate-700/50">
                     <i class="fa-solid fa-arrow-left mr-2"></i>Back to Editor
                 </button>
                 
                 <button onclick="sharePortfolio()" class="glass px-4 py-2 rounded-lg transition-colors hover:bg-slate-700/50">
                     <i class="fas fa-share-nodes mr-2"></i>Share Portfolio
                 </button>
                 
                 <div class="ml-auto flex items-center space-x-2">
                     <span class="text-sm text-gray-400">Your portfolio is live at:</span>
                     <div class="glass px-3 py-1 rounded-lg flex items-center">
                         <span id="portfolioLink" class="text-sm font-mono text-indigo-400"></span>
                         <button onclick="copyLink()" class="ml-2 text-gray-400 hover:text-white">
                             <i class="fas fa-copy"></i>
                         </button>
                     </div>
                 </div>
            </div>
            
            <div id="portfolioDisplay" class="glass p-6 md:p-8 rounded-2xl shadow-2xl transition-all duration-500">
                <!-- Portfolio content will be rendered here -->
            </div>
            
            <!-- LinkedIn Preview Section -->
            <div class="mt-8 linkedin-preview-container">
                <h3 class="text-xl font-bold mb-4 text-center">LinkedIn Preview</h3>
                <div class="linkedin-preview">
                    <div class="linkedin-preview-image" id="linkedinPreviewImage">
                        Image Preview
                    </div>
                    <div class="linkedin-preview-content">
                        <div class="linkedin-preview-title" id="linkedinPreviewTitle">Portfolio Title</div>
                        <div class="linkedin-preview-url" id="linkedinPreviewUrl">portfolio.example.com</div>
                    </div>
                </div>
                <p class="text-sm text-gray-400 text-center mt-2">This is how your portfolio will appear when shared on LinkedIn</p>
            </div>
            
            <!-- QR Code and Social Sharing Section -->
            <div class="mt-8 glass p-6 rounded-2xl">
                <h3 class="text-xl font-bold mb-4 text-center">Share Your Portfolio</h3>
                
                <div class="flex flex-col md:flex-row items-center justify-between gap-8">
                    <div class="flex flex-col items-center">
                        <div id="qrcode" class="mb-2"></div>
                        <p class="text-sm text-gray-400">Scan QR code to share</p>
                    </div>
                    
                    <div class="flex flex-col items-center">
                        <p class="text-lg font-medium mb-4">Share on social media</p>
                        <div class="flex justify-center space-x-4">
                            <a href="#" id="share-twitter" class="text-blue-400 hover:text-blue-300" target="_blank">
                                <i class="fab fa-twitter text-2xl"></i>
                            </a>
                            <a href="#" id="share-facebook" class="text-blue-600 hover:text-blue-500" target="_blank">
                                <i class="fab fa-facebook text-2xl"></i>
                            </a>
                            <a href="#" id="share-linkedin" class="text-blue-700 hover:text-blue-600" target="_blank">
                                <i class="fab fa-linkedin text-2xl"></i>
                            </a>
                        </div>
                    </div>
                    
                    <div class="flex flex-col items-center">
                        <p class="text-lg font-medium mb-4">Direct link</p>
                        <div class="glass px-4 py-2 rounded-lg flex items-center">
                            <span id="directLink" class="text-sm font-mono text-indigo-400"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-6 right-6 glass px-6 py-3 rounded-lg shadow-lg transform translate-y-20 transition-transform duration-300 flex items-center">
        <i id="toastIcon" class="fas fa-check-circle text-green-500 mr-3"></i>
        <span id="toastMessage">Notification</span>
    </div>
    
    <script>
        // --- GLOBAL STATE & CONSTANTS ---
        // Determine the API URL based on the current environment
        const API_URL = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
            ? 'http://localhost:3000'
            : 'https://portfolioforge-backend.onrender.com'; // Replace with your deployed backend URL
        
        let SHAREABLE_URL = ''; // Will be set to the IP-based URL
        let PUBLIC_URL = ''; // Will be set to a public URL (like ngrok)
        let portfolioData = {};
        let profilePictureUrl = '';
        let currentView = 'landingView';
        let portfolioId = '';
        let selectedTheme = 'Default';
        
        // --- DOM ELEMENT REFERENCES ---
        const views = {
            landingView: document.getElementById('landingView'),
            featuresView: document.getElementById('featuresView'),
            contactView: document.getElementById('contactView'),
            aiView: document.getElementById('aiView'),
            editorView: document.getElementById('editorView'),
            portfolioView: document.getElementById('portfolioView'),
        };
        
        const aiUploader = document.getElementById('aiUploader');
        const aiLoading = document.getElementById('aiLoading');
        const photoInput = document.getElementById('photoInput');
        const resumeInput = document.getElementById('resumeInput');
        const photoDropZone = document.getElementById('photoDropZone');
        const resumeDropZone = document.getElementById('resumeDropZone');
        const generateBtn = document.getElementById('generateBtn');
        const portfolioDisplay = document.getElementById('portfolioDisplay');
        const portfolioLink = document.getElementById('portfolioLink');
        const directLink = document.getElementById('directLink');
        const saveAndPreviewBtn = document.getElementById('saveAndPreviewBtn');
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toastMessage');
        const toastIcon = document.getElementById('toastIcon');
        const statusIndicator = document.getElementById('statusIndicator');
        const statusText = document.getElementById('statusText');
        const contactForm = document.getElementById('contactForm');
        const linkedinPreviewImage = document.getElementById('linkedinPreviewImage');
        const linkedinPreviewTitle = document.getElementById('linkedinPreviewTitle');
        const linkedinPreviewUrl = document.getElementById('linkedinPreviewUrl');
        
        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', async () => {
            // Show a notification about the backend status
            if (window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1') {
                showToast('This demo is using a mock backend. Some features may not work.', 'info');
                
                // Disable AI generation for demo
                generateBtn.addEventListener('click', () => {
                    showToast('AI generation requires a backend server. This is a frontend demo.', 'error');
                });
                
                // Disable save for demo
                saveAndPreviewBtn.addEventListener('click', () => {
                    showToast('Saving requires a backend server. This is a frontend demo.', 'error');
                });
            } else {
                // Fetch server info to get the local IP
                try {
                    const response = await fetch(`${API_URL}/api/server-info`);
                    const serverInfo = await response.json();
                    SHAREABLE_URL = serverInfo.url;
                    console.log(`Shareable URL set to: ${SHAREABLE_URL}`);
                    updateNetworkStatus(true, `Server accessible at ${SHAREABLE_URL}`);
                } catch (error) {
                    console.error('Failed to get server info:', error);
                    // Fallback: try to use the current host with the backend port
                    const currentHost = window.location.hostname;
                    const backendPort = API_URL.split(':')[2] || '3000';
                    SHAREABLE_URL = `http://${currentHost}:${backendPort}`;
                    console.log(`Fallback shareable URL set to: ${SHAREABLE_URL}`);
                    updateNetworkStatus(false, `Using fallback URL: ${SHAREABLE_URL}`);
                }
                
                // Check if there's a public URL (like from ngrok) in the URL parameters
                const urlParams = new URLSearchParams(window.location.search);
                const publicUrlParam = urlParams.get('public_url');
                if (publicUrlParam) {
                    PUBLIC_URL = publicUrlParam;
                    console.log(`Public URL set to: ${PUBLIC_URL}`);
                    showToast('Using public URL for LinkedIn sharing', 'success');
                }
                
                setupDropZone(photoDropZone, photoInput, document.getElementById('photoLabel'));
                setupDropZone(resumeDropZone, resumeInput, document.getElementById('resumeLabel'));
                generateBtn.addEventListener('click', handleGenerateClick);
            }
            
            // Setup contact form submission
            contactForm.addEventListener('submit', handleContactSubmit);
            
            // Setup theme selection
            document.querySelectorAll('.theme-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.theme-option').forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedTheme = this.dataset.theme;
                });
            });
            
            // Set default theme
            document.querySelector('[data-theme="Default"]').classList.add('selected');
            
            // Setup editor photo upload
            const editorPhotoDropZone = document.querySelector('#editorView .drop-zone');
            const editorPhotoInput = document.getElementById('editorPhotoInput');
            setupDropZone(editorPhotoDropZone, editorPhotoInput);
            editorPhotoInput.addEventListener('change', handleEditorPhotoChange);
            
            // Create floating particles
            createParticles();
            
            // Test network connectivity
            testNetworkConnectivity();
        });
        
        // --- NETWORK CONNECTIVITY ---
        function updateNetworkStatus(isConnected, message) {
            statusIndicator.classList.toggle('error', !isConnected);
            statusText.textContent = message;
        }
        
        async function testNetworkConnectivity() {
            // Only test connectivity if we're on localhost
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                try {
                    const response = await fetch(`${API_URL}/health`, { 
                        method: 'GET',
                        timeout: 5000
                    });
                    if (response.ok) {
                        updateNetworkStatus(true, 'Connected to server');
                    } else {
                        updateNetworkStatus(false, 'Server error');
                    }
                } catch (error) {
                    updateNetworkStatus(false, 'Cannot connect to server');
                    console.error('Network connectivity test failed:', error);
                }
            } else {
                updateNetworkStatus(false, 'Backend not available in demo mode');
            }
        }
        
        // --- PARTICLE EFFECT ---
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 30;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                
                // Random size
                const size = Math.random() * 10 + 5;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                
                // Random position
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.top = `${Math.random() * 100}%`;
                
                // Random opacity
                particle.style.opacity = Math.random() * 0.5 + 0.1;
                
                // Random animation duration
                const duration = Math.random() * 50 + 20;
                particle.style.animation = `float ${duration}s infinite ease-in-out`;
                
                particlesContainer.appendChild(particle);
            }
        }
        
        // Add CSS for floating animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes float {
                0%, 100% { transform: translateY(0) translateX(0); }
                25% { transform: translateY(-20px) translateX(10px); }
                50% { transform: translateY(10px) translateX(-10px); }
                75% { transform: translateY(-15px) translateX(5px); }
            }
        `;
        document.head.appendChild(style);
        
        // --- VIEW MANAGEMENT ---
        function switchView(viewId) {
            Object.values(views).forEach(view => view.classList.add('hidden'));
            if (views[viewId]) {
                views[viewId].classList.remove('hidden');
                currentView = viewId;
                
                // Generate QR code when portfolio view is shown
                if (viewId === 'portfolioView') {
                    generateQRCode();
                    setupSocialSharing();
                }
            } else {
                console.error(`View with ID '${viewId}' not found.`);
            }
        }
        
        function handleBackToEditor() {
            // Pre-fill editor with current data before switching
            populateEditor(portfolioData, selectedTheme);
            switchView('editorView');
        }
        
        // --- FILE UPLOAD & DROPZONE LOGIC ---
        function setupDropZone(zone, input, label) {
            const defaultLabel = label ? label.textContent : '';
            zone.addEventListener('click', () => input.click());
            
            zone.addEventListener('dragover', (e) => {
                e.preventDefault();
                zone.classList.add('dragover');
            });
            zone.addEventListener('dragleave', () => zone.classList.remove('dragover'));
            
            zone.addEventListener('drop', (e) => {
                e.preventDefault();
                zone.classList.remove('dragover');
                if (e.dataTransfer.files.length) {
                    input.files = e.dataTransfer.files;
                    if (label) updateLabel(input, label, zone, defaultLabel);
                }
            });
            
            if (label) {
                input.addEventListener('change', () => updateLabel(input, label, zone, defaultLabel));
            }
        }
        
        function updateLabel(input, label, zone, defaultLabel) {
             if (input.files.length > 0) {
                label.textContent = `✅ ${input.files[0].name}`;
                zone.classList.add('has-file');
            } else {
                label.textContent = defaultLabel;
                zone.classList.remove('has-file');
            }
        }
        
        function handleEditorPhotoChange() {
            const file = this.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    profilePictureUrl = e.target.result;
                    document.getElementById('profilePhotoPreview').innerHTML = 
                        `<img src="${profilePictureUrl}" alt="Profile" class="w-full h-full object-cover">`;
                };
                reader.readAsDataURL(file);
            }
        }
        
        // --- API & DATA HANDLING ---
        async function handleGenerateClick() {
            if (resumeInput.files.length === 0) {
                showToast('Please upload a resume (PDF) to continue.', 'error');
                return;
            }
            
            aiUploader.classList.add('hidden');
            aiLoading.classList.remove('hidden');
            
            const formData = new FormData();
            formData.append('resume', resumeInput.files[0]);
            if (photoInput.files.length > 0) {
                formData.append('photo', photoInput.files[0]);
            }
            
            try {
                const response = await fetch(`${API_URL}/api/generate-from-resume`, { 
                    method: 'POST', 
                    body: formData 
                });
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || 'Failed to generate portfolio.');
                }
                
                const result = await response.json();
                
                // Store data globally
                portfolioId = result.portfolioId;
                portfolioData = result.portfolioData;
                profilePictureUrl = result.profilePictureUrl;
                selectedTheme = result.theme.name;
                
                renderPortfolio(portfolioData, result.theme, profilePictureUrl, portfolioId);
                switchView('portfolioView');
                
                // Update portfolio links
                const portfolioUrl = `${PUBLIC_URL || SHAREABLE_URL}/portfolio/${portfolioId}`;
                portfolioLink.textContent = portfolioUrl;
                directLink.textContent = portfolioUrl;
                
                showToast('Portfolio generated successfully!', 'success');
            } catch (error) {
                console.error(error);
                showToast(error.message, 'error');
                aiUploader.innerHTML = `
                    <div class="text-center text-red-400">
                        <h3>Generation Failed</h3>
                        <p>${error.message}</p>
                        <button class="mt-4 bg-slate-600 px-4 py-2 rounded-lg" onclick="location.reload()">Try Again</button>
                    </div>
                `;
            } finally {
                aiLoading.classList.add('hidden');
                aiUploader.classList.remove('hidden'); 
            }
        }
        
        // --- CONTACT FORM HANDLER ---
        function handleContactSubmit(e) {
            e.preventDefault();
            
            const name = document.getElementById('contactName').value;
            const email = document.getElementById('contactEmail').value;
            const message = document.getElementById('contactMessage').value;
            
            // Here you would normally send the data to a server
            console.log({ name, email, message });
            
            // Show a success message
            showToast('Message sent successfully!', 'success');
            
            // Reset the form
            contactForm.reset();
        }
        
        // --- EDITOR LOGIC ---
        function populateEditor(data, themeName) {
            // Personal info
            document.getElementById('edit-name').value = data.personalInfo?.name || '';
            document.getElementById('edit-email').value = data.personalInfo?.email || '';
            document.getElementById('edit-phone').value = data.personalInfo?.phone || '';
            document.getElementById('edit-website').value = data.personalInfo?.website || '';
            
            // Extract usernames from URLs
            const linkedinUsername = extractUsernameFromUrl(data.personalInfo?.linkedin, 'linkedin');
            const githubUsername = extractUsernameFromUrl(data.personalInfo?.github, 'github');
            
            document.getElementById('edit-linkedin').value = linkedinUsername || '';
            document.getElementById('edit-github').value = githubUsername || '';
            
            // Summary
            document.getElementById('edit-summary').value = data.summary || '';
            
            // Skills
            document.getElementById('edit-skills').value = Array.isArray(data.skills) ? data.skills.join(', ') : '';
            
            // Experience
            const experienceContainer = document.getElementById('experienceContainer');
            experienceContainer.innerHTML = '';
            if (data.experience && data.experience.length > 0) {
                data.experience.forEach((exp, index) => {
                    addExperience(exp, index);
                });
            } else {
                addExperience();
            }
            
            // Projects
            const projectsContainer = document.getElementById('projectsContainer');
            projectsContainer.innerHTML = '';
            if (data.projects && data.projects.length > 0) {
                data.projects.forEach((proj, index) => {
                    addProject(proj, index);
                });
            } else {
                addProject();
            }
            
            // Theme
            document.querySelectorAll('.theme-option').forEach(opt => opt.classList.remove('selected'));
            const themeOption = document.querySelector(`[data-theme="${themeName}"]`);
            if (themeOption) {
                themeOption.classList.add('selected');
                selectedTheme = themeName;
            }
            
            // Profile photo
            if (profilePictureUrl) {
                document.getElementById('profilePhotoPreview').innerHTML = 
                    `<img src="${profilePictureUrl}" alt="Profile" class="w-full h-full object-cover">`;
            }
        }
        
        function addExperience(data = {}, index = Date.now()) {
            const container = document.getElementById('experienceContainer');
            const expDiv = document.createElement('div');
            expDiv.className = 'glass p-4 rounded-lg';
            expDiv.dataset.index = index;
            
            expDiv.innerHTML = `
                <div class="flex justify-between items-center mb-3">
                    <h4 class="font-bold">Experience ${container.children.length + 1}</h4>
                    <button onclick="removeExperience(${index})" class="text-red-400 hover:text-red-300">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                    <input type="text" placeholder="Company" class="editor-input exp-company" value="${data.company || ''}">
                    <input type="text" placeholder="Role" class="editor-input exp-role" value="${data.role || ''}">
                    <input type="text" placeholder="Dates (e.g., Jan 2020 - Present)" class="editor-input exp-dates" value="${data.dates || ''}">
                    <textarea placeholder="Description (bullet points)" rows="3" class="editor-input exp-description">${data.description ? data.description.join('\n') : ''}</textarea>
                </div>
            `;
            
            container.appendChild(expDiv);
        }
        
        function removeExperience(index) {
            const expDiv = document.querySelector(`[data-index="${index}"]`);
            if (expDiv) {
                expDiv.remove();
            }
        }
        
        function addProject(data = {}, index = Date.now()) {
            const container = document.getElementById('projectsContainer');
            const projDiv = document.createElement('div');
            projDiv.className = 'glass p-4 rounded-lg';
            projDiv.dataset.index = index;
            
            projDiv.innerHTML = `
                <div class="flex justify-between items-center mb-3">
                    <h4 class="font-bold">Project ${container.children.length + 1}</h4>
                    <button onclick="removeProject(${index})" class="text-red-400 hover:text-red-300">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                </div>
                <div class="space-y-3">
                    <input type="text" placeholder="Project Title" class="editor-input proj-title" value="${data.title || ''}">
                    <textarea placeholder="Project Description" rows="3" class="editor-input proj-description">${data.description || ''}</textarea>
                    <input type="text" placeholder="Project Link (URL)" class="editor-input proj-link" value="${data.link || ''}">
                </div>
            `;
            
            container.appendChild(projDiv);
        }
        
        function removeProject(index) {
            const projDiv = document.querySelector(`[data-index="${index}"]`);
            if (projDiv) {
                projDiv.remove();
            }
        }
        
        // --- SAVE AND PREVIEW FUNCTION ---
        async function saveAndPreview() {
            // Show loading state
            const originalBtnText = saveAndPreviewBtn.innerHTML;
            saveAndPreviewBtn.innerHTML = '<div class="spinner"></div> Saving...';
            saveAndPreviewBtn.disabled = true;
            
            try {
                // Collect data from the form
                const updatedData = {
                    personalInfo: {
                        name: document.getElementById('edit-name').value,
                        email: document.getElementById('edit-email').value,
                        phone: document.getElementById('edit-phone').value,
                        website: document.getElementById('edit-website').value,
                        linkedin: convertToUrl('linkedin', document.getElementById('edit-linkedin').value),
                        github: convertToUrl('github', document.getElementById('edit-github').value),
                    },
                    summary: document.getElementById('edit-summary').value,
                    skills: document.getElementById('edit-skills').value.split(',').map(s => s.trim()).filter(Boolean),
                    experience: [],
                    projects: [],
                };
                
                // Collect experience data
                document.querySelectorAll('#experienceContainer > div').forEach(expDiv => {
                    const company = expDiv.querySelector('.exp-company').value;
                    const role = expDiv.querySelector('.exp-role').value;
                    const dates = expDiv.querySelector('.exp-dates').value;
                    const description = expDiv.querySelector('.exp-description').value.split('\n').filter(Boolean);
                    
                    if (company || role) {
                        updatedData.experience.push({ company, role, dates, description });
                    }
                });
                
                // Collect project data
                document.querySelectorAll('#projectsContainer > div').forEach(projDiv => {
                    const title = projDiv.querySelector('.proj-title').value;
                    const description = projDiv.querySelector('.proj-description').value;
                    const link = projDiv.querySelector('.proj-link').value;
                    
                    if (title) {
                        updatedData.projects.push({ title, description, link });
                    }
                });
                
                // Get selected theme
                const themeName = selectedTheme;
                const theme = themes[themeName] || themes['Default'];
                
                // If we have a portfolioId, update the existing portfolio
                if (portfolioId) {
                    console.log('Updating existing portfolio with ID:', portfolioId);
                    
                    const response = await fetch(`${API_URL}/api/update-portfolio/${portfolioId}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            portfolioData: updatedData,
                            theme,
                            profilePictureUrl
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        portfolioData = updatedData;
                        renderPortfolio(updatedData, theme, profilePictureUrl, portfolioId);
                        switchView('portfolioView');
                        
                        // Update portfolio links
                        const portfolioUrl = `${PUBLIC_URL || SHAREABLE_URL}/portfolio/${portfolioId}`;
                        portfolioLink.textContent = portfolioUrl;
                        directLink.textContent = portfolioUrl;
                        
                        showToast('Portfolio updated successfully!', 'success');
                    } else {
                        throw new Error('Failed to update portfolio');
                    }
                } else {
                    console.log('Creating new portfolio');
                    
                    // Create new portfolio (manual creation)
                    // Prepare form data with photo if uploaded
                    const formData = new FormData();
                    formData.append('portfolioData', JSON.stringify(updatedData));
                    formData.append('theme', JSON.stringify(theme));
                    
                    // Add photo if uploaded in editor
                    const editorPhotoInput = document.getElementById('editorPhotoInput');
                    if (editorPhotoInput.files.length > 0) {
                        formData.append('photo', editorPhotoInput.files[0]);
                    }
                    
                    const response = await fetch(`${API_URL}/api/create-manual-portfolio`, {
                        method: 'POST',
                        body: formData
                    });
                    
                    const result = await response.json();
                    
                    if (result.portfolioId) {
                        portfolioId = result.portfolioId;
                        portfolioData = updatedData;
                        profilePictureUrl = result.profilePictureUrl;
                        
                        renderPortfolio(updatedData, theme, profilePictureUrl, portfolioId);
                        switchView('portfolioView');
                        
                        // Update portfolio links
                        const portfolioUrl = `${PUBLIC_URL || SHAREABLE_URL}/portfolio/${portfolioId}`;
                        portfolioLink.textContent = portfolioUrl;
                        directLink.textContent = portfolioUrl;
                        
                        showToast('Portfolio created successfully!', 'success');
                    } else {
                        throw new Error('Failed to create portfolio');
                    }
                }
            } catch (error) {
                console.error('Error in saveAndPreview:', error);
                showToast(`Error: ${error.message || 'Failed to save portfolio'}`, 'error');
            } finally {
                // Reset button state
                saveAndPreviewBtn.innerHTML = originalBtnText;
                saveAndPreviewBtn.disabled = false;
            }
        }
        
        // --- HELPER FUNCTIONS FOR URL/USERNAME CONVERSION ---
        function convertToUrl(platform, username) {
            if (!username) return '';
            
            // If it's already a URL, return as is
            if (username.startsWith('http://') || username.startsWith('https://')) {
                return username;
            }
            
            if (platform === 'linkedin') {
                return `https://linkedin.com/in/${username}`;
            } else if (platform === 'github') {
                return `https://github.com/${username}`;
            }
            
            return username;
        }
        
        function extractUsernameFromUrl(url, platform) {
            if (!url) return '';
            
            try {
                // If it's not a URL, return as is (might be just the username)
                if (!url.startsWith('http://') && !url.startsWith('https://')) {
                    return url;
                }
                
                const urlObj = new URL(url);
                const pathname = urlObj.pathname;
                
                if (platform === 'linkedin') {
                    // LinkedIn URL: https://linkedin.com/in/username
                    const parts = pathname.split('/');
                    // Find the part after 'in'
                    const inIndex = parts.indexOf('in');
                    if (inIndex !== -1 && inIndex + 1 < parts.length) {
                        return parts[inIndex + 1];
                    }
                } else if (platform === 'github') {
                    // GitHub URL: https://github.com/username
                    const parts = pathname.split('/').filter(Boolean);
                    if (parts.length >= 1) {
                        return parts[0];
                    }
                }
            } catch (e) {
                console.error('Error parsing URL:', e);
            }
            
            return url;
        }
        
        // --- META TAGS UPDATE FUNCTION ---
        function updateMetaTags(data, portfolioUrl, profilePicUrl) {
            // If profilePicUrl is a data URL, we need to convert it to a publicly accessible URL
            let imageUrl = profilePicUrl;
            
            // Check if the image is a data URL (base64 encoded)
            if (profilePicUrl && profilePicUrl.startsWith('data:')) {
                // For data URLs, we need to create a public endpoint to serve the image
                // In a real implementation, you would upload this to a CDN or image hosting service
                // For now, we'll use a placeholder image
                imageUrl = `https://via.placeholder.com/1200x627/4F46E5/FFFFFF?text=${encodeURIComponent(data.personalInfo.name || 'Portfolio')}`;
                
                // If you have a public server, you can create an endpoint to serve the image
                // For example: imageUrl = `${PUBLIC_URL || SHAREABLE_URL}/api/portfolio-image/${portfolioId}`;
            }
            
            // Update document title
            document.title = `${data.personalInfo.name || 'Portfolio'} | Professional Portfolio`;
            // Update Open Graph meta tags
            const ogTitle = document.querySelector('meta[property="og:title"]');
            if (ogTitle) ogTitle.setAttribute('content', document.title);
            
            const ogDescription = document.querySelector('meta[property="og:description"]');
            if (ogDescription) {
                const description = data.summary || 
                    `${data.personalInfo.name || 'A professional'} with expertise in ${Array.isArray(data.skills) ? data.skills.map(s => typeof s === 'string' ? s : s.name).join(', ') : 'various fields'}.`;
                ogDescription.setAttribute('content', description);
            }
            
            const ogImage = document.querySelector('meta[property="og:image"]');
            if (ogImage) ogImage.setAttribute('content', imageUrl);
            
            const ogUrl = document.querySelector('meta[property="og:url"]');
            if (ogUrl) ogUrl.setAttribute('content', portfolioUrl);
            // Update Twitter Card meta tags
            const twitterTitle = document.querySelector('meta[name="twitter:title"]');
            if (twitterTitle) twitterTitle.setAttribute('content', document.title);
            
            const twitterDescription = document.querySelector('meta[name="twitter:description"]');
            if (twitterDescription) {
                const description = data.summary || 
                    `${data.personalInfo.name || 'A professional'} with expertise in ${Array.isArray(data.skills) ? data.skills.map(s => typeof s === 'string' ? s : s.name).join(', ') : 'various fields'}.`;
                twitterDescription.setAttribute('content', description);
            }
            
            const twitterImage = document.querySelector('meta[name="twitter:image"]');
            if (twitterImage) twitterImage.setAttribute('content', imageUrl);
            // Update canonical URL
            let canonicalLink = document.querySelector('link[rel="canonical"]');
            if (!canonicalLink) {
                canonicalLink = document.createElement('link');
                canonicalLink.rel = 'canonical';
                document.head.appendChild(canonicalLink);
            }
            canonicalLink.setAttribute('href', portfolioUrl);
            
            // Update LinkedIn preview
            linkedinPreviewTitle.textContent = document.title;
            linkedinPreviewUrl.textContent = new URL(portfolioUrl).hostname;
            
            // If we have a public image URL, show it in the preview
            if (imageUrl && !imageUrl.startsWith('data:')) {
                linkedinPreviewImage.innerHTML = `<img src="${imageUrl}" alt="Preview" class="w-full h-full object-cover">`;
            } else {
                linkedinPreviewImage.textContent = 'Image Preview';
            }
            
            // Log the meta tags for debugging
            console.log('Meta tags updated:', {
                title: document.title,
                description: ogDescription ? ogDescription.getAttribute('content') : 'N/A',
                imageUrl: ogImage ? ogImage.getAttribute('content') : 'N/A',
                url: ogUrl ? ogUrl.getAttribute('content') : 'N/A'
            });
        }
        
        // --- RENDERING ---
        function renderPortfolio(data, theme, picUrl, portfolioId) {
            const { personalInfo, summary, skills, experience, projects, education } = data;
            
            // Apply theme classes
            portfolioDisplay.className = `${theme.background} ${theme.font} p-6 md:p-8 rounded-2xl shadow-2xl transition-all duration-500`;
            
            // Update meta tags for social sharing
            const portfolioUrl = `${PUBLIC_URL || SHAREABLE_URL}/portfolio/${portfolioId}`;
            updateMetaTags(data, portfolioUrl, picUrl);
                    
            const skillsHtml = Array.isArray(skills) && skills.length > 0
                ? skills.map(skill => `<span class="${theme.primaryColor} text-white text-sm font-medium mr-2 mb-2 px-3 py-1 rounded-full">${typeof skill === 'string' ? skill : skill.name}</span>`).join('')
                : '<p class="text-gray-400">No skills listed.</p>';
                    
            const experienceHtml = Array.isArray(experience) && experience.length > 0
                ? experience.map(job => `
                    <div class="mb-6">
                        <div class="flex flex-col md:flex-row md:justify-between md:items-start mb-2">
                            <h4 class="text-xl font-bold">${job.role || 'Role'}</h4>
                            <span class="text-sm ${theme.secondaryColor}">${job.dates || ''}</span>
                        </div>
                        <p class="${theme.secondaryColor} mb-3">${job.company || 'Company'}</p>
                        <ul class="list-disc list-inside text-gray-300 space-y-1">
                            ${(job.description || []).map(d => `<li>${d}</li>`).join('')}
                        </ul>
                    </div>
                `).join('')
                : '<p class="text-gray-400">No work experience listed.</p>';
            
            const projectsHtml = Array.isArray(projects) && projects.length > 0
                ? projects.map(proj => `
                    <div class="${theme.card} p-5 rounded-xl mb-4 border border-gray-700">
                        <div class="flex justify-between items-start mb-3">
                            <h4 class="font-bold text-lg ${theme.secondaryColor}">${proj.title || 'Project Title'}</h4>
                            ${proj.link ? `<a href="${proj.link}" target="_blank" class="text-blue-400 hover:text-blue-300 transition-colors"><i class="fas fa-external-link-alt"></i></a>` : ''}
                        </div>
                        <p class="text-gray-300">${proj.description || ''}</p>
                    </div>
                `).join('')
                : '<p class="text-gray-400">No projects listed.</p>';
            
            // Update social links to include email (mailto), LinkedIn, GitHub, and website
            const socialLinksHtml = `
                ${personalInfo.email ? `
                    <a href="mailto:${personalInfo.email}" class="social-link ${theme.secondaryColor} hover:text-white transition-colors" title="Email">
                        <i class="fas fa-envelope text-xl"></i>
                    </a>` : ''}
                ${personalInfo.linkedin ? `
                    <a href="${personalInfo.linkedin}" target="_blank" class="social-link ${theme.secondaryColor} hover:text-white transition-colors" title="LinkedIn">
                        <i class="fab fa-linkedin text-xl"></i>
                    </a>` : ''}
                ${personalInfo.github ? `
                    <a href="${personalInfo.github}" target="_blank" class="social-link ${theme.secondaryColor} hover:text-white transition-colors" title="GitHub">
                        <i class="fab fa-github text-xl"></i>
                    </a>` : ''}
                ${personalInfo.website ? `
                    <a href="${personalInfo.website}" target="_blank" class="social-link ${theme.secondaryColor} hover:text-white transition-colors" title="Website">
                        <i class="fas fa-globe text-xl"></i>
                    </a>` : ''}
            `;
            
            portfolioDisplay.innerHTML = `
                <header class="flex flex-col md:flex-row items-center text-center md:text-left gap-8 mb-12">
                    <img src="${picUrl}" alt="Profile Picture" class="w-40 h-40 rounded-full border-4 ${theme.secondaryColor.replace('text-','border-')} object-cover shadow-lg">
                    <div>
                        <h1 class="text-4xl md:text-5xl font-bold mb-2">${personalInfo.name || 'Your Name'}</h1>
                        <p class="text-xl ${theme.secondaryColor} mb-4">
                            ${personalInfo.email ? 
                                `<a href="mailto:${personalInfo.email}" class="hover:underline">${personalInfo.email}</a>` : 
                                'your.email@example.com'}
                        </p>
                        ${personalInfo.phone ? `<p class="text-gray-400 mb-4"><i class="fas fa-phone mr-2"></i>${personalInfo.phone}</p>` : ''}
                        <div class="flex justify-center md:justify-start gap-4 mt-2">
                            ${socialLinksHtml}
                        </div>
                    </div>
                </header>
                
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-2 space-y-8">
                        <section>
                            <h2 class="text-2xl font-bold border-b-2 ${theme.secondaryColor.replace('text-','border-')} pb-2 mb-4">Professional Summary</h2>
                            <p class="text-gray-300 text-lg">${summary || 'No summary provided.'}</p>
                        </section>
                        
                        <section>
                            <h2 class="text-2xl font-bold border-b-2 ${theme.secondaryColor.replace('text-','border-')} pb-2 mb-4">Work Experience</h2>
                            ${experienceHtml}
                        </section>
                    </div>
                    
                    <div class="lg:col-span-1 space-y-8">
                        <section>
                            <h2 class="text-2xl font-bold border-b-2 ${theme.secondaryColor.replace('text-','border-')} pb-2 mb-4">Skills</h2>
                            <div class="flex flex-wrap">${skillsHtml}</div>
                        </section>
                        
                        <section>
                            <h2 class="text-2xl font-bold border-b-2 ${theme.secondaryColor.replace('text-','border-')} pb-2 mb-4">Projects</h2>
                            ${projectsHtml}
                        </section>
                    </div>
                </div>
                
                <!-- Add a button to test the sharing functionality -->
                <div class="mt-6 text-center">
                    <button onclick="testSharing()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg">
                        Test Sharing Functionality
                    </button>
                </div>
            `;
        }
        
        // --- SHARING & LINK MANAGEMENT ---
        function testSharing() {
            if (!portfolioId || !PUBLIC_URL && !SHAREABLE_URL) {
                console.error('Cannot test sharing: missing portfolioId or URLs');
                showToast('Portfolio not ready for sharing', 'error');
                return;
            }
            
            const portfolioUrl = `${PUBLIC_URL || SHAREABLE_URL}/portfolio/${portfolioId}`;
            
            console.log('Testing sharing functionality');
            console.log('Portfolio URL:', portfolioUrl);
            console.log('Meta tags:');
            console.log('  - Title:', document.querySelector('meta[property="og:title"]').getAttribute('content'));
            console.log('  - Description:', document.querySelector('meta[property="og:description"]').getAttribute('content'));
            console.log('  - Image:', document.querySelector('meta[property="og:image"]').getAttribute('content'));
            console.log('  - URL:', document.querySelector('meta[property="og:url"]').getAttribute('content'));
            
            showToast('Check console for sharing details', 'info');
        }
        
        function generateQRCode(url) {
            // If no URL is provided, use the current portfolio link
            if (!url) {
                url = directLink.textContent;
            }
            
            console.log(`Generating QR code with URL: ${url}`);
            if (url) {
                const qrcodeContainer = document.getElementById('qrcode');
                qrcodeContainer.innerHTML = ''; // Clear previous QR code
                
                // Check if QRCode library is available
                if (typeof QRCode === 'undefined') {
                    console.error('QRCode library not loaded');
                    qrcodeContainer.innerHTML = '<p class="text-red-500">QR Code library not available</p>';
                    return;
                }
                
                console.log(`Full URL for QR code: ${url}`);
                
                new QRCode(qrcodeContainer, {
                    text: url,
                    width: 128,
                    height: 128,
                    colorDark: "#000000",
                    colorLight: "#ffffff",
                    correctLevel: QRCode.CorrectLevel.H
                });
            } else {
                console.error('Cannot generate QR code: missing URL');
                showToast('Cannot generate QR code: missing portfolio information', 'error');
            }
        }
        
        function setupSocialSharing(shareUrl) {
            // If no URL is provided, use the current portfolio link
            if (!shareUrl) {
                shareUrl = directLink.textContent;
            }
            
            if (!shareUrl) {
                console.error('Cannot setup social sharing: missing URL');
                return;
            }
            
            const portfolioTitle = `${portfolioData.personalInfo.name || 'My'} Portfolio`;
            const portfolioDescription = portfolioData.summary || 'Check out my professional portfolio';
            
            console.log(`Setting up social sharing with URL: ${shareUrl}`);
            
            // Twitter
            const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(portfolioTitle)}&url=${encodeURIComponent(shareUrl)}`;
            document.getElementById('share-twitter').href = twitterUrl;
            console.log(`Twitter share URL: ${twitterUrl}`);
            
            // Facebook
            const facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}`;
            document.getElementById('share-facebook').href = facebookUrl;
            console.log(`Facebook share URL: ${facebookUrl}`);
            
            // LinkedIn
            const linkedinUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(shareUrl)}`;
            document.getElementById('share-linkedin').href = linkedinUrl;
            console.log(`LinkedIn share URL: ${linkedinUrl}`);
        }
        
        async function sharePortfolio() {
            if (!portfolioData || Object.keys(portfolioData).length === 0) {
                showToast('Please create a portfolio first', 'error');
                return;
            }
            
            try {
                // Call Netlify Function to generate shareable link
                const response = await fetch('/.netlify/functions/share-portfolio', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        portfolioData,
                        profilePictureUrl,
                        selectedTheme
                    })
                });
                
                if (!response.ok) {
                    throw new Error('Failed to generate shareable link');
                }
                
                const { shareUrl, shareId } = await response.json();
                
                // Update UI with shareable link
                portfolioLink.textContent = shareUrl;
                directLink.textContent = shareUrl;
                
                // Generate QR code
                generateQRCode(shareUrl);
                
                // Setup social sharing
                setupSocialSharing(shareUrl);
                
                // Show success message
                showToast('Portfolio is ready to share!', 'success');
                
                // Switch to portfolio view
                switchView('portfolioView');
            } catch (error) {
                console.error('Error sharing portfolio:', error);
                showToast('Failed to share portfolio. Please try again.', 'error');
            }
        }
        
        function copyLink() {
            // Get the current link from the UI
            const link = directLink.textContent;
            console.log(`Copying link: ${link}`);
            
            // Use the modern Clipboard API
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(link)
                    .then(() => {
                        showToast('Link copied to clipboard!', 'success');
                        console.log('Link copied successfully');
                    })
                    .catch(err => {
                        console.error('Failed to copy link:', err);
                        // Fallback for older browsers
                        fallbackCopyTextToClipboard(link);
                    });
            } else {
                // Fallback for older browsers
                fallbackCopyTextToClipboard(link);
            }
        }
        
        // Fallback for copying text to clipboard
        function fallbackCopyTextToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            
            // Avoid scrolling to bottom
            textArea.style.top = "0";
            textArea.style.left = "0";
            textArea.style.position = "fixed";
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    showToast('Link copied to clipboard!', 'success');
                    console.log('Link copied successfully (fallback)');
                } else {
                    showToast('Failed to copy link', 'error');
                }
            } catch (err) {
                console.error('Fallback: Oops, unable to copy', err);
                showToast('Failed to copy link', 'error');
            }
            
            document.body.removeChild(textArea);
        }
        
        // --- NOTIFICATION SYSTEM ---
        function showToast(message, type = 'success') {
            toastMessage.textContent = message;
            
            // Update icon based on type
            if (type === 'success') {
                toastIcon.className = 'fas fa-check-circle text-green-500 mr-3';
            } else if (type === 'error') {
                toastIcon.className = 'fas fa-exclamation-circle text-red-500 mr-3';
            } else if (type === 'info') {
                toastIcon.className = 'fas fa-info-circle text-blue-500 mr-3';
            }
            
            // Show toast
            toast.classList.remove('translate-y-20');
            
            // Hide after 3 seconds
            setTimeout(() => {
                toast.classList.add('translate-y-20');
            }, 3000);
        }
        
        // --- THEME DEFINITIONS ---
        const themes = {
            'Software Developer': {
                name: 'Developer Dark',
                background: 'bg-gray-900 text-white',
                primaryColor: 'bg-blue-500',
                secondaryColor: 'text-blue-400',
                card: 'bg-gray-800',
                font: 'font-mono',
                buttonStyle: 'bg-blue-600 hover:bg-blue-700'
            },
            'Graphic Designer': {
                name: 'Designer Light',
                background: 'bg-white text-gray-800',
                primaryColor: 'bg-pink-500',
                secondaryColor: 'text-pink-500',
                card: 'bg-gray-50',
                font: 'font-sans',
                buttonStyle: 'bg-pink-600 hover:bg-pink-700'
            },
            'Data Scientist': {
                name: 'Data Green',
                background: 'bg-gray-800 text-gray-100',
                primaryColor: 'bg-green-500',
                secondaryColor: 'text-green-400',
                card: 'bg-gray-700',
                font: 'font-sans',
                buttonStyle: 'bg-green-600 hover:bg-green-700'
            },
            'Default': {
                name: 'Professional Blue',
                background: 'bg-gray-100 text-gray-900',
                primaryColor: 'bg-indigo-600',
                secondaryColor: 'text-indigo-500',
                card: 'bg-white',
                font: 'font-sans',
                buttonStyle: 'bg-indigo-600 hover:bg-indigo-700'
            }
        };
    </script>
</body>
</html>